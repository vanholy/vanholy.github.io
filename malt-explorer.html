<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Esploratore Malti per Homebrewing</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #f5af19 0%, #f12711 100%);
            color: white;
            padding: 30px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        .header::before {
            content: "üç∫";
            position: absolute;
            font-size: 150px;
            opacity: 0.1;
            left: -30px;
            top: -20px;
            animation: float 6s ease-in-out infinite;
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(5deg); }
        }
        
        h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
            position: relative;
            z-index: 1;
        }
        
        .subtitle {
            font-size: 1.1em;
            opacity: 0.95;
            position: relative;
            z-index: 1;
        }
        
        .search-section {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 30px;
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            align-items: flex-end;
        }
        
        .search-group {
            flex: 1;
            min-width: 200px;
        }
        
        .search-group label {
            display: block;
            color: white;
            margin-bottom: 8px;
            font-weight: 500;
            font-size: 0.95em;
        }
        
        .search-group input, .search-group select {
            width: 100%;
            padding: 12px 15px;
            border: none;
            border-radius: 10px;
            font-size: 1em;
            background: white;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }
        
        .search-group input:focus, .search-group select:focus {
            outline: none;
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
        }
        
        .btn-search {
            padding: 12px 30px;
            background: linear-gradient(135deg, #f5af19 0%, #f12711 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .btn-search:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
        }
        
        .btn-search:active {
            transform: translateY(0);
        }
        
        .tabs {
            display: flex;
            background: #f0f0f0;
            padding: 0;
        }
        
        .tab {
            flex: 1;
            padding: 15px;
            background: transparent;
            border: none;
            cursor: pointer;
            font-size: 1em;
            font-weight: 500;
            color: #666;
            transition: all 0.3s ease;
            position: relative;
        }
        
        .tab.active {
            background: white;
            color: #764ba2;
            font-weight: 600;
        }
        
        .tab.active::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        .tab:hover:not(.active) {
            background: rgba(255, 255, 255, 0.5);
        }
        
        .content {
            padding: 30px;
            display: none;
        }
        
        .content.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .results-count {
            margin-bottom: 20px;
            padding: 15px;
            background: linear-gradient(135deg, #e0f7fa 0%, #b2ebf2 100%);
            border-radius: 10px;
            font-weight: 500;
            color: #00695c;
        }
        
        .malt-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .malt-card {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
            transition: all 0.3s ease;
            border: 2px solid transparent;
            position: relative;
            overflow: hidden;
        }
        
        .malt-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 50%, #f5af19 100%);
            transform: scaleX(0);
            transition: transform 0.3s ease;
        }
        
        .malt-card:hover::before {
            transform: scaleX(1);
        }
        
        .malt-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
            border-color: #667eea;
        }
        
        .malt-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 15px;
        }
        
        .malt-name {
            font-size: 1.3em;
            font-weight: 600;
            color: #333;
            margin-bottom: 5px;
        }
        
        .malt-type {
            display: inline-block;
            padding: 4px 12px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: 500;
        }
        
        .malt-producer {
            color: #666;
            font-size: 0.95em;
            margin-bottom: 15px;
            font-style: italic;
        }
        
        .malt-specs {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .spec-item {
            padding: 8px 12px;
            background: #f8f9fa;
            border-radius: 8px;
            border-left: 3px solid #667eea;
        }
        
        .spec-label {
            font-size: 0.85em;
            color: #666;
            margin-bottom: 2px;
        }
        
        .spec-value {
            font-weight: 600;
            color: #333;
        }
        
        .malt-description {
            color: #555;
            line-height: 1.6;
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid #e0e0e0;
            font-size: 0.95em;
        }
        
        .color-bar {
            height: 20px;
            border-radius: 10px;
            margin: 10px 0;
            background: linear-gradient(90deg, 
                #fef1b5 0%, 
                #fdd55f 20%, 
                #f4a742 40%, 
                #c55a11 60%, 
                #6b3410 80%, 
                #1a0e05 100%);
            position: relative;
        }
        
        .color-indicator {
            position: absolute;
            top: -5px;
            width: 30px;
            height: 30px;
            background: white;
            border: 3px solid #333;
            border-radius: 50%;
            transform: translateX(-50%);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }
        
        .style-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .style-card {
            background: linear-gradient(135deg, #fff 0%, #f5f5f5 100%);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .style-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
        }
        
        .style-name {
            font-size: 1.2em;
            font-weight: 600;
            color: #333;
            margin-bottom: 10px;
        }
        
        .style-specs {
            margin-top: 10px;
            padding-top: 10px;
            border-top: 1px solid #e0e0e0;
        }
        
        .style-malts {
            margin-top: 10px;
            padding: 10px;
            background: rgba(102, 126, 234, 0.1);
            border-radius: 8px;
            font-size: 0.9em;
            line-height: 1.5;
        }
        
        .converter-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .converter-card {
            background: linear-gradient(135deg, #fff 0%, #f9f9f9 100%);
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
        }
        
        .converter-card h3 {
            color: #333;
            margin-bottom: 15px;
            font-size: 1.1em;
        }
        
        .converter-input {
            width: 100%;
            padding: 10px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 1em;
            margin-bottom: 10px;
        }
        
        .converter-result {
            padding: 15px;
            background: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%);
            border-radius: 8px;
            font-weight: 600;
            color: #2e7d32;
            text-align: center;
            margin-top: 10px;
        }
        
        .recipe-builder {
            background: #f9f9f9;
            padding: 20px;
            border-radius: 15px;
            margin-top: 20px;
        }
        
        .selected-malts {
            margin-top: 20px;
        }
        
        .selected-malt-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            background: white;
            border-radius: 8px;
            margin-bottom: 10px;
        }
        
        .percentage-input {
            width: 80px;
            padding: 5px;
            border: 2px solid #e0e0e0;
            border-radius: 5px;
        }
        
        .total-percentage {
            margin-top: 15px;
            padding: 15px;
            background: linear-gradient(135deg, #fff3e0 0%, #ffe0b2 100%);
            border-radius: 8px;
            font-weight: 600;
            color: #e65100;
        }
        
        .add-btn {
            background: linear-gradient(135deg, #4caf50 0%, #45a049 100%);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            width: 100%;
            margin-top: 10px;
        }
        
        .add-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        
        @media (max-width: 768px) {
            .malt-grid, .style-grid {
                grid-template-columns: 1fr;
            }
            
            .search-section {
                flex-direction: column;
            }
            
            .search-group {
                width: 100%;
            }
            
            h1 {
                font-size: 2em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üç∫ Esploratore Malti per Homebrewing</h1>
            <p class="subtitle">Database completo per la birrificazione casalinga - Compatibile con Brewfather</p>
        </div>
        
        <div class="search-section">
            <div class="search-group">
                <label for="searchName">Nome Malto</label>
                <input type="text" id="searchName" placeholder="Es. Pilsner, Munich, Crystal...">
            </div>
            <div class="search-group">
                <label for="searchType">Tipo</label>
                <select id="searchType">
                    <option value="">Tutti i tipi</option>
                    <option value="base">Base</option>
                    <option value="crystal">Crystal/Caramel</option>
                    <option value="roasted">Tostato</option>
                    <option value="special">Speciale</option>
                    <option value="wheat">Frumento</option>
                    <option value="other">Altri Cereali</option>
                </select>
            </div>
            <div class="search-group">
                <label for="searchColor">Colore (EBC)</label>
                <select id="searchColor">
                    <option value="">Tutti i colori</option>
                    <option value="0-10">Molto chiaro (0-10 EBC)</option>
                    <option value="10-30">Chiaro (10-30 EBC)</option>
                    <option value="30-60">Ambrato (30-60 EBC)</option>
                    <option value="60-120">Scuro (60-120 EBC)</option>
                    <option value="120-300">Molto scuro (120-300 EBC)</option>
                    <option value="300+">Nero (300+ EBC)</option>
                </select>
            </div>
            <div class="search-group">
                <label for="searchProducer">Produttore</label>
                <select id="searchProducer">
                    <option value="">Tutti i produttori</option>
                    <option value="Weyermann">Weyermann</option>
                    <option value="Bestmalz">Bestmalz</option>
                    <option value="Dingemans">Dingemans</option>
                    <option value="Simpson's">Simpson's</option>
                    <option value="Crisp">Crisp</option>
                    <option value="Briess">Briess</option>
                    <option value="Castle">Castle Malting</option>
                </select>
            </div>
            <button class="btn-search" id="searchButton">üîç Cerca</button>
        </div>
        
        <div class="tabs">
            <button class="tab active" data-tab="malts">üì¶ Malti</button>
            <button class="tab" data-tab="styles">üç∫ Stili Birra</button>
            <button class="tab" data-tab="converter">üîÑ Convertitore</button>
            <button class="tab" data-tab="recipe">üìù Costruttore Ricetta</button>
        </div>
        
        <div id="malts" class="content active">
            <div class="results-count" id="resultsCount">
                Trovati <span id="countNumber">0</span> malti
            </div>
            <div class="malt-grid" id="maltGrid"></div>
        </div>
        
        <div id="styles" class="content">
            <h2 style="margin-bottom: 20px; color: #333;">Stili di Birra e Malti Consigliati</h2>
            <div class="style-grid" id="styleGrid"></div>
        </div>
        
        <div id="converter" class="content">
            <h2 style="margin-bottom: 20px; color: #333;">Convertitore Unit√† di Misura</h2>
            <div class="converter-section">
                <div class="converter-card">
                    <h3>EBC ‚Üî SRM</h3>
                    <input type="number" id="ebcInput" class="converter-input" placeholder="Inserisci EBC">
                    <div id="srmResult" class="converter-result">SRM: --</div>
                </div>
                <div class="converter-card">
                    <h3>SRM ‚Üî EBC</h3>
                    <input type="number" id="srmInput" class="converter-input" placeholder="Inserisci SRM">
                    <div id="ebcResult" class="converter-result">EBC: --</div>
                </div>
                <div class="converter-card">
                    <h3>¬∞Lovibond ‚Üî SRM</h3>
                    <input type="number" id="lovibondInput" class="converter-input" placeholder="Inserisci ¬∞L">
                    <div id="lovibondResult" class="converter-result">SRM: --</div>
                </div>
                <div class="converter-card">
                    <h3>Estratto (kg) ‚Üí Punti Gravit√†</h3>
                    <input type="number" id="extractInput" class="converter-input" placeholder="Kg di malto">
                    <input type="number" id="volumeInput" class="converter-input" placeholder="Litri finali">
                    <div id="gravityResult" class="converter-result">OG: ----</div>
                </div>
            </div>
        </div>
        
        <div id="recipe" class="content">
            <h2 style="margin-bottom: 20px; color: #333;">Costruttore Ricetta</h2>
            <div class="recipe-builder">
                <p style="margin-bottom: 15px;">Seleziona i malti dalla scheda "Malti" per aggiungerli alla ricetta</p>
                <div class="selected-malts" id="selectedMalts">
                    <p style="color: #666;">Nessun malto selezionato</p>
                </div>
                <div class="total-percentage" id="totalPercentage">Totale: 0%</div>
                <button class="btn-search" id="calculateButton" style="margin-top: 20px;">Calcola Colore Finale</button>
                <div id="recipeResult" style="margin-top: 20px;"></div>
            </div>
        </div>
    </div>
    
    <script>
        // Database Malti
        const maltsDatabase = [
            // Malti Base
            {
                name: "Pilsner",
                type: "base",
                producer: "Weyermann",
                ebc: 3.5,
                extract: 81,
                description: "Malto base tedesco premium, ideale per Pilsner, Helles, K√∂lsch. Note di miele leggero e malto dolce.",
                maxUsage: 100,
                protein: 11,
                diastaticPower: 250
            },
            {
                name: "BEST Pilsen",
                type: "base",
                producer: "Bestmalz",
                ebc: 4,
                extract: 80.5,
                description: "Eccellenza tedesca, colore 3-4.9 EBC. Ideale per tutti gli stili di birra. pH mosto 5.7-6.1",
                maxUsage: 100,
                protein: 10.5,
                diastaticPower: 250
            },
            {
                name: "Pilsen MD",
                type: "base",
                producer: "Dingemans",
                ebc: 3.5,
                extract: 80,
                description: "Malto Pilsner belga di alta qualit√†. Supporta fino al 40% di cereali adiuvanti.",
                maxUsage: 100,
                protein: 11.5,
                diastaticPower: 230
            },
            {
                name: "Maris Otter",
                type: "base",
                producer: "Simpson's",
                ebc: 6,
                extract: 81,
                description: "Il 'Rolls Royce' dei malti britannici. Note di pane, biscotto e nocciola. Ideale per Bitter e IPA.",
                maxUsage: 100,
                protein: 9.6,
                diastaticPower: 120
            },
            {
                name: "Golden Promise",
                type: "base",
                producer: "Simpson's",
                ebc: 5,
                extract: 81,
                description: "Profilo pi√π dolce del Maris Otter. Corpo robusto, ideale per Scottish Ales e IPA.",
                maxUsage: 100,
                protein: 10,
                diastaticPower: 71
            },
            {
                name: "Pale Ale MD",
                type: "base",
                producer: "Dingemans",
                ebc: 9,
                extract: 80,
                description: "Tradizione belga con specifiche moderne. Supporta stili ad alta densit√†.",
                maxUsage: 100,
                protein: 12,
                diastaticPower: 230
            },
            {
                name: "Vienna",
                type: "base",
                producer: "Weyermann",
                ebc: 7.5,
                extract: 80,
                description: "Note di miele, nocciola e tostato leggero. Pu√≤ essere usato come malto base unico.",
                maxUsage: 100,
                protein: 11,
                diastaticPower: 140
            },
            {
                name: "Munich I",
                type: "base",
                producer: "Weyermann",
                ebc: 15,
                extract: 78,
                description: "Munich chiaro, mantiene attivit√† enzimatica. Crosta di pane e nocciola.",
                maxUsage: 100,
                protein: 11.5,
                diastaticPower: 100
            },
            {
                name: "Munich II",
                type: "base",
                producer: "Weyermann",
                ebc: 25,
                extract: 78,
                description: "Munich scuro, richiede supporto diastatico. Intenso maltato caramellato.",
                maxUsage: 80,
                protein: 11.5,
                diastaticPower: 50
            },
            
            // Malti Crystal/Caramel  
            {
                name: "Caramel 20L",
                type: "crystal",
                producer: "Briess",
                ebc: 55,
                extract: 80,
                description: "Caramello leggero e toffee. Colore dorato, corpo senza sovrastare il luppolo.",
                maxUsage: 15,
                protein: 13,
                diastaticPower: 0
            },
            {
                name: "CaraGlow",
                type: "crystal",
                producer: "Simpson's",
                ebc: 15,
                extract: 75,
                description: "Crystal estremamente leggero. Dolcezza sottile e note fruttate.",
                maxUsage: 15,
                protein: 11,
                diastaticPower: 0
            },
            {
                name: "Crystal T50‚Ñ¢",
                type: "crystal",
                producer: "Simpson's",
                ebc: 133,
                extract: 69,
                description: "Precisione assoluta a 50¬∞L. Note di miele, toffee e malto. Cristallizzazione 85% minimo.",
                maxUsage: 20,
                protein: 10,
                diastaticPower: 0
            },
            {
                name: "Caramel 60L",
                type: "crystal",
                producer: "Briess",
                ebc: 160,
                extract: 79,
                description: "Carattere caramellato pronunciato. Colori dal dorato profondo al rosso.",
                maxUsage: 15,
                protein: 13,
                diastaticPower: 0
            },
            {
                name: "Crystal Dark",
                type: "crystal",
                producer: "Simpson's",
                ebc: 267,
                extract: 69,
                description: "Caramello bruciato, toffee e uvetta. Colori profondi senza astringenza.",
                maxUsage: 15,
                protein: 10,
                diastaticPower: 0
            },
            {
                name: "Special B",
                type: "crystal",
                producer: "Castle",
                ebc: 290,
                extract: 68,
                description: "Double-roasting belga. Uvetta, fichi, caramello sharp. Ideale per Belgian Ales.",
                maxUsage: 10,
                protein: 11,
                diastaticPower: 0
            },
            {
                name: "Crystal Red¬Æ",
                type: "crystal",
                producer: "Briess",
                ebc: 530,
                extract: 73,
                description: "Intensit√† cromatica rivoluzionaria. Colori intensi con utilizzi minimi (1-5%).",
                maxUsage: 5,
                protein: 12,
                diastaticPower: 0
            },
            
            // Malti Tostati
            {
                name: "CARAFA¬Æ Type I",
                type: "roasted",
                producer: "Weyermann",
                ebc: 900,
                extract: 70,
                description: "Caff√®, cacao, mandorla tostata. Colore e carattere senza eccessiva amarezza.",
                maxUsage: 5,
                protein: 11,
                diastaticPower: 0
            },
            {
                name: "CARAFA¬Æ Special I",
                type: "roasted",
                producer: "Weyermann",
                ebc: 900,
                extract: 70,
                description: "Debittered senza glumelle. Ridotta astringenza, ideale per Black IPA.",
                maxUsage: 10,
                protein: 11,
                diastaticPower: 0
            },
            {
                name: "Chocolate Malt",
                type: "roasted",
                producer: "Simpson's",
                ebc: 1100,
                extract: 66,
                description: "Cioccolato intenso, caff√®. Equilibrio perfetto per Porter e Stout.",
                maxUsage: 10,
                protein: 10,
                diastaticPower: 0
            },
            {
                name: "Black Patent",
                type: "roasted",
                producer: "Briess",
                ebc: 1340,
                extract: 55,
                description: "Carattere neutro-sharp. Colore nero intenso, richiede bilanciamento attento.",
                maxUsage: 10,
                protein: 13,
                diastaticPower: 0
            },
            {
                name: "Blackprinz¬Æ",
                type: "roasted",
                producer: "Briess",
                ebc: 1340,
                extract: 55,
                description: "Debittered da orzo hulless. Smooth, senza amarezza per Black IPA e Schwarzbier.",
                maxUsage: 10,
                protein: 13,
                diastaticPower: 0
            },
            {
                name: "Roasted Barley",
                type: "roasted",
                producer: "Simpson's",
                ebc: 1400,
                extract: 55,
                description: "Orzo tostato non maltato. Carattere secco e astringente tipico delle Stout.",
                maxUsage: 10,
                protein: 11,
                diastaticPower: 0
            },
            
            // Malti Speciali
            {
                name: "Acidulated",
                type: "special",
                producer: "Weyermann",
                ebc: 4,
                extract: 76,
                description: "Riduce pH mash ~0.1 per 1%. Acidificazione naturale senza off-flavors.",
                maxUsage: 10,
                protein: 11,
                diastaticPower: 0
            },
            {
                name: "Melanoidin",
                type: "special",
                producer: "Weyermann",
                ebc: 70,
                extract: 75,
                description: "Intensi aromi maltati, miele e biscotto. Reazioni di Maillard controllate.",
                maxUsage: 20,
                protein: 11,
                diastaticPower: 0
            },
            {
                name: "Aromatic",
                type: "special",
                producer: "Simpson's",
                ebc: 58,
                extract: 70,
                description: "Complessit√† dolce-acida. Note di uvetta, miele e malto intenso.",
                maxUsage: 50,
                protein: 11,
                diastaticPower: 0
            },
            {
                name: "Biscuit 50 MD",
                type: "special",
                producer: "Dingemans",
                ebc: 58,
                extract: 75,
                description: "Intenso sapore di biscotto e aroma di pane caldo. Il pi√π leggero dei tostati.",
                maxUsage: 25,
                protein: 10.5,
                diastaticPower: 0
            },
            {
                name: "Beechwood Smoked",
                type: "special",
                producer: "Weyermann",
                ebc: 6,
                extract: 77,
                description: "Tradizione Bamberg. Fumo di faggio, vaniglia e miele. 36-48h di affumicatura.",
                maxUsage: 100,
                protein: 11,
                diastaticPower: 140
            },
            {
                name: "Cherrywood Smoked",
                type: "special",
                producer: "Briess",
                ebc: 12,
                extract: 80,
                description: "Alternativa americana dolce. Carattere affumicato per Porter e Stout.",
                maxUsage: 60,
                protein: 12,
                diastaticPower: 140
            },
            
            // Malti di Frumento
            {
                name: "Wheat Malt",
                type: "wheat",
                producer: "Weyermann",
                ebc: 4,
                extract: 83,
                description: "Frumento maltato tedesco. Corpo, schiuma stabile, note di pane.",
                maxUsage: 80,
                protein: 13,
                diastaticPower: 150
            },
            {
                name: "Wheat Malt White",
                type: "wheat",
                producer: "Bestmalz",
                ebc: 4,
                extract: 83,
                description: "Premium per Weizen. Banana e chiodo di garofano con lieviti appropriati.",
                maxUsage: 80,
                protein: 13.5,
                diastaticPower: 160
            },
            {
                name: "Carawheat¬Æ",
                type: "wheat",
                producer: "Weyermann",
                ebc: 120,
                extract: 76,
                description: "Crystal di frumento. Corpo intenso, sapore di pane e caramello.",
                maxUsage: 15,
                protein: 13,
                diastaticPower: 0
            },
            
            // Altri Cereali
            {
                name: "Flaked Oats",
                type: "other",
                producer: "Generic",
                ebc: 2,
                extract: 70,
                description: "Avena in fiocchi. Mouthfeel cremoso e setoso per Stout e NEIPA.",
                maxUsage: 30,
                protein: 12,
                diastaticPower: 0
            },
            {
                name: "Golden Naked Oats¬Æ",
                type: "other",
                producer: "Simpson's",
                ebc: 10,
                extract: 70,
                description: "Crystal huskless di avena. Cremoso, nutty, breakfast cereal bar.",
                maxUsage: 10,
                protein: 11,
                diastaticPower: 0
            },
            {
                name: "Rye Malt",
                type: "other",
                producer: "Weyermann",
                ebc: 6,
                extract: 77,
                description: "Segale maltata. Carattere speziato distintivo, richiede rice hulls >20%.",
                maxUsage: 50,
                protein: 11,
                diastaticPower: 90
            },
            {
                name: "Flaked Barley",
                type: "other",
                producer: "Generic",
                ebc: 3,
                extract: 70,
                description: "Orzo in fiocchi. Corpo e cremosit√† senza carattere intenso.",
                maxUsage: 40,
                protein: 10,
                diastaticPower: 0
            }
        ];
        
        // Database Stili Birra
        const beerStyles = [
            {
                name: "German Pilsner",
                og: "1.044-1.050",
                fg: "1.008-1.013",
                ibu: "25-45",
                abv: "4.4-5.2%",
                ebc: "4-7",
                malts: "90-100% Pilsner",
                description: "Birra chiara, luppolata, con finale secco e amaro persistente."
            },
            {
                name: "Munich Helles",
                og: "1.044-1.048",
                fg: "1.006-1.012",
                ibu: "16-22",
                abv: "4.7-5.4%",
                ebc: "6-10",
                malts: "90-95% Pilsner, 5-10% Munich/Vienna",
                description: "Lager maltata delicata, bilanciata verso il malto."
            },
            {
                name: "Vienna Lager",
                og: "1.048-1.055",
                fg: "1.010-1.014",
                ibu: "18-30",
                abv: "4.7-5.5%",
                ebc: "18-30",
                malts: "50-70% Vienna, 30-50% Pilsner, fino 10% Munich",
                description: "Maltata, tostata, ambrata con finale pulito."
            },
            {
                name: "M√§rzen/Oktoberfest",
                og: "1.054-1.060",
                fg: "1.010-1.014",
                ibu: "18-24",
                abv: "5.6-6.0%",
                ebc: "16-34",
                malts: "40-60% Munich, 30-40% Pilsner/Vienna, 5-10% CaraMunich",
                description: "Maltata, ricca, tradizionale festa bavarese."
            },
            {
                name: "English Bitter",
                og: "1.030-1.038",
                fg: "1.007-1.011",
                ibu: "25-35",
                abv: "3.2-3.8%",
                ebc: "16-28",
                malts: "85-95% Maris Otter, 5-10% Crystal 60-80L",
                description: "Session beer luppolata con carattere maltato britannico."
            },
            {
                name: "English IPA",
                og: "1.050-1.075",
                fg: "1.010-1.018",
                ibu: "40-60",
                abv: "5.0-7.5%",
                ebc: "12-28",
                malts: "85-95% Maris Otter/Pale, 5-10% Crystal 40-60L, opz. 2% biscuit",
                description: "Luppolata tradizionale con luppoli britannici."
            },
            {
                name: "American IPA",
                og: "1.056-1.070",
                fg: "1.008-1.014",
                ibu: "40-70",
                abv: "5.5-7.5%",
                ebc: "12-28",
                malts: "90-95% 2-Row/Pale, 5-7% Crystal 40L, 3% Munich/Vienna opz.",
                description: "Luppolata americana con agrumi e resina."
            },
            {
                name: "NEIPA (New England IPA)",
                og: "1.060-1.085",
                fg: "1.010-1.015",
                ibu: "25-50",
                abv: "6.0-9.0%",
                ebc: "8-15",
                malts: "60-70% Pale/Pilsner, 15-20% Wheat/Oats, 5-10% Munich",
                description: "Torbida, cremosa, fruttata con mouthfeel setoso."
            },
            {
                name: "Belgian Witbier",
                og: "1.044-1.052",
                fg: "1.008-1.012",
                ibu: "10-20",
                abv: "4.5-5.5%",
                ebc: "4-8",
                malts: "50% Pilsner, 45% Wheat, 5% Flaked Oats",
                description: "Speziata con coriandolo e buccia d'arancia."
            },
            {
                name: "Hefeweizen",
                og: "1.044-1.052",
                fg: "1.010-1.014",
                ibu: "8-15",
                abv: "4.3-5.6%",
                ebc: "4-14",
                malts: "50-70% Wheat, 30-50% Pilsner",
                description: "Banana e chiodo di garofano dal lievito Weizen."
            },
            {
                name: "Porter",
                og: "1.048-1.060",
                fg: "1.012-1.016",
                ibu: "18-35",
                abv: "4.5-6.5%",
                ebc: "40-80",
                malts: "70-80% Pale, 10% Brown, 5-10% Crystal 80L, 5% Chocolate",
                description: "Tostata, cioccolato, caff√® con corpo medio."
            },
            {
                name: "Irish Stout",
                og: "1.036-1.044",
                fg: "1.007-1.011",
                ibu: "25-45",
                abv: "4.0-4.5%",
                ebc: "50-100",
                malts: "70% Pale, 20% Flaked Barley, 10% Roasted Barley",
                description: "Secca, tostata, caff√® con schiuma cremosa."
            },
            {
                name: "Imperial Stout",
                og: "1.075-1.115",
                fg: "1.018-1.030",
                ibu: "50-90",
                abv: "8.0-12.0%",
                ebc: "60-100",
                malts: "75-85% Pale/Maris Otter, 5-10% Crystal 120L, 5-10% Chocolate/Black",
                description: "Intensa, complessa, alcolica con frutta scura."
            },
            {
                name: "Belgian Dubbel",
                og: "1.062-1.075",
                fg: "1.008-1.018",
                ibu: "15-25",
                abv: "6.0-7.6%",
                ebc: "20-34",
                malts: "80-85% Pilsner/Pale, 10% Munich, 5% Special B, 5% CaraMunich",
                description: "Maltata, frutta scura, spezie dal lievito belga."
            },
            {
                name: "Belgian Tripel",
                og: "1.075-1.085",
                fg: "1.008-1.014",
                ibu: "20-40",
                abv: "7.5-9.5%",
                ebc: "9-14",
                malts: "90-95% Pilsner, 5-10% zucchero candito chiaro",
                description: "Dorata, speziata, secca con finale alcolico."
            },
            {
                name: "Saison",
                og: "1.048-1.065",
                fg: "1.002-1.012",
                ibu: "20-35",
                abv: "5.0-7.0%",
                ebc: "10-28",
                malts: "80-90% Pilsner, 5-10% Vienna/Munich, 5% Wheat opz.",
                description: "Secca, speziata, rustica con alta attenuazione."
            },
            {
                name: "Schwarzbier",
                og: "1.046-1.052",
                fg: "1.010-1.016",
                ibu: "20-30",
                abv: "4.4-5.4%",
                ebc: "35-60",
                malts: "80-90% Pilsner, 5-10% Munich, 3-6% Carafa Special",
                description: "Nera ma leggera, smooth senza astringenza."
            },
            {
                name: "Bock",
                og: "1.064-1.072",
                fg: "1.013-1.019",
                ibu: "20-27",
                abv: "6.3-7.2%",
                ebc: "28-46",
                malts: "50-70% Munich, 30-50% Pilsner, fino 10% Crystal",
                description: "Maltata forte, ricca, tradizionale tedesca."
            }
        ];
        
        // Malti selezionati per ricetta
        let selectedMaltsForRecipe = [];
        
        // Funzioni di ricerca
        window.searchMalts = function() {
            const nameFilter = document.getElementById('searchName').value.toLowerCase();
            const typeFilter = document.getElementById('searchType').value;
            const colorFilter = document.getElementById('searchColor').value;
            const producerFilter = document.getElementById('searchProducer').value;
            
            let filteredMalts = maltsDatabase.filter(malt => {
                let matches = true;
                
                if (nameFilter && !malt.name.toLowerCase().includes(nameFilter)) {
                    matches = false;
                }
                
                if (typeFilter && malt.type !== typeFilter) {
                    matches = false;
                }
                
                if (producerFilter && malt.producer !== producerFilter) {
                    matches = false;
                }
                
                if (colorFilter) {
                    const ebc = malt.ebc;
                    switch(colorFilter) {
                        case '0-10':
                            if (ebc > 10) matches = false;
                            break;
                        case '10-30':
                            if (ebc < 10 || ebc > 30) matches = false;
                            break;
                        case '30-60':
                            if (ebc < 30 || ebc > 60) matches = false;
                            break;
                        case '60-120':
                            if (ebc < 60 || ebc > 120) matches = false;
                            break;
                        case '120-300':
                            if (ebc < 120 || ebc > 300) matches = false;
                            break;
                        case '300+':
                            if (ebc < 300) matches = false;
                            break;
                    }
                }
                
                return matches;
            });
            
            displayMalts(filteredMalts);
        }
        
        // Funzione per visualizzare i malti
        function displayMalts(malts) {
            const grid = document.getElementById('maltGrid');
            const count = document.getElementById('countNumber');
            count.textContent = malts.length;
            
            grid.innerHTML = malts.map((malt, index) => `
                <div class="malt-card">
                    <div class="malt-header">
                        <div>
                            <div class="malt-name">${malt.name}</div>
                            <div class="malt-producer">${malt.producer}</div>
                        </div>
                        <span class="malt-type">${getTypeLabel(malt.type)}</span>
                    </div>
                    <div class="color-bar">
                        <div class="color-indicator" style="left: ${Math.min(95, (malt.ebc / 1500) * 100)}%"></div>
                    </div>
                    <div class="malt-specs">
                        <div class="spec-item">
                            <div class="spec-label">Colore</div>
                            <div class="spec-value">${malt.ebc} EBC / ${ebcToSrm(malt.ebc).toFixed(1)} SRM</div>
                        </div>
                        <div class="spec-item">
                            <div class="spec-label">Estratto</div>
                            <div class="spec-value">${malt.extract}%</div>
                        </div>
                        <div class="spec-item">
                            <div class="spec-label">Max utilizzo</div>
                            <div class="spec-value">${malt.maxUsage}%</div>
                        </div>
                        <div class="spec-item">
                            <div class="spec-label">Potere diastatico</div>
                            <div class="spec-value">${malt.diastaticPower || 0} ¬∞L</div>
                        </div>
                    </div>
                    <div class="malt-description">${malt.description}</div>
                    <button class="add-btn" data-malt-index="${index}">
                        ‚ûï Aggiungi alla ricetta
                    </button>
                </div>
            `).join('');
            
            // Aggiungi event listeners ai bottoni
            document.querySelectorAll('.add-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const index = parseInt(this.getAttribute('data-malt-index'));
                    const selectedMalt = malts[index];
                    window.addToRecipe(selectedMalt);
                });
            });
        }
        
        // Funzione per aggiungere malto alla ricetta
        window.addToRecipe = function(malt) {
            const existing = selectedMaltsForRecipe.find(m => 
                m.name === malt.name && m.producer === malt.producer
            );
            
            if (!existing) {
                selectedMaltsForRecipe.push({
                    ...malt,
                    percentage: 0
                });
                updateRecipeBuilder();
                alert(`${malt.name} aggiunto alla ricetta!`);
            } else {
                alert(`${malt.name} √® gi√† nella ricetta!`);
            }
        }
        
        // Aggiorna il costruttore di ricette
        function updateRecipeBuilder() {
            const container = document.getElementById('selectedMalts');
            
            if (selectedMaltsForRecipe.length === 0) {
                container.innerHTML = '<p style="color: #666;">Nessun malto selezionato</p>';
                return;
            }
            
            container.innerHTML = selectedMaltsForRecipe.map((malt, index) => `
                <div class="selected-malt-item">
                    <div>
                        <strong>${malt.name}</strong> (${malt.producer})
                        <br><small>${malt.ebc} EBC | Estratto: ${malt.extract}%</small>
                    </div>
                    <div>
                        <input type="number" class="percentage-input" 
                            data-index="${index}" 
                            value="${malt.percentage}" 
                            min="0" max="100" step="0.5">
                        <span>%</span>
                        <button class="remove-btn" data-index="${index}" 
                            style="margin-left: 10px; padding: 5px 10px; background: #f44336; color: white; border: none; border-radius: 5px; cursor: pointer;">
                            ‚ùå
                        </button>
                    </div>
                </div>
            `).join('');
            
            // Event listeners per percentuali
            document.querySelectorAll('.percentage-input').forEach(input => {
                input.addEventListener('change', function() {
                    const index = parseInt(this.getAttribute('data-index'));
                    window.updatePercentage(index, parseFloat(this.value) || 0);
                });
            });
            
            // Event listeners per rimozione
            document.querySelectorAll('.remove-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const index = parseInt(this.getAttribute('data-index'));
                    window.removeFromRecipe(index);
                });
            });
            
            updateTotalPercentage();
        }
        
        // Aggiorna percentuale malto
        window.updatePercentage = function(index, value) {
            selectedMaltsForRecipe[index].percentage = value;
            updateTotalPercentage();
        }
        
        // Rimuovi malto dalla ricetta
        window.removeFromRecipe = function(index) {
            selectedMaltsForRecipe.splice(index, 1);
            updateRecipeBuilder();
        }
        
        // Aggiorna totale percentuale
        function updateTotalPercentage() {
            const total = selectedMaltsForRecipe.reduce((sum, malt) => sum + malt.percentage, 0);
            const element = document.getElementById('totalPercentage');
            element.textContent = `Totale: ${total.toFixed(1)}%`;
            element.style.color = Math.abs(total - 100) < 0.01 ? '#2e7d32' : '#e65100';
        }
        
        // Calcola ricetta
        window.calculateRecipe = function() {
            const total = selectedMaltsForRecipe.reduce((sum, malt) => sum + malt.percentage, 0);
            
            if (Math.abs(total - 100) > 0.01) {
                alert('Il totale deve essere 100%!');
                return;
            }
            
            // Calcola colore finale (formula Morey semplificata)
            let totalMCU = 0;
            selectedMaltsForRecipe.forEach(malt => {
                const srm = ebcToSrm(malt.ebc);
                totalMCU += (srm * malt.percentage) / 100;
            });
            
            const finalSRM = 1.4922 * Math.pow(totalMCU, 0.6859);
            const finalEBC = srmToEbc(finalSRM);
            
            const resultDiv = document.getElementById('recipeResult');
            resultDiv.innerHTML = `
                <div style="padding: 20px; background: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%); border-radius: 10px;">
                    <h3 style="margin-bottom: 15px;">Risultato Ricetta</h3>
                    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px;">
                        <div>
                            <strong>Colore stimato:</strong><br>
                            ${finalEBC.toFixed(1)} EBC / ${finalSRM.toFixed(1)} SRM
                        </div>
                        <div>
                            <strong>Estratto medio:</strong><br>
                            ${(selectedMaltsForRecipe.reduce((sum, m) => sum + (m.extract * m.percentage / 100), 0)).toFixed(1)}%
                        </div>
                    </div>
                    <div class="color-bar" style="margin-top: 15px;">
                        <div class="color-indicator" style="left: ${Math.min(95, (finalEBC / 100) * 100)}%"></div>
                    </div>
                </div>
            `;
        }
        
        // Helper functions per conversioni
        function getTypeLabel(type) {
            const labels = {
                'base': 'Base',
                'crystal': 'Crystal',
                'roasted': 'Tostato',
                'special': 'Speciale',
                'wheat': 'Frumento',
                'other': 'Altri'
            };
            return labels[type] || type;
        }
        
        function ebcToSrm(ebc) {
            return ebc * 0.508;
        }
        
        function srmToEbc(srm) {
            return srm * 1.97;
        }
        
        function srmToLovibond(srm) {
            return (srm + 0.6) / 1.3546;
        }
        
        function lovibondToSrm(lovibond) {
            return (1.35 * lovibond) - 0.76;
        }
        
        // Funzioni per il convertitore
        window.convertEBC = function() {
            const ebc = parseFloat(document.getElementById('ebcInput').value);
            if (!isNaN(ebc)) {
                const srm = ebcToSrm(ebc);
                document.getElementById('srmResult').textContent = `SRM: ${srm.toFixed(2)}`;
            } else {
                document.getElementById('srmResult').textContent = 'SRM: --';
            }
        }
        
        window.convertSRM = function() {
            const srm = parseFloat(document.getElementById('srmInput').value);
            if (!isNaN(srm)) {
                const ebc = srmToEbc(srm);
                document.getElementById('ebcResult').textContent = `EBC: ${ebc.toFixed(2)}`;
            } else {
                document.getElementById('ebcResult').textContent = 'EBC: --';
            }
        }
        
        window.convertLovibond = function() {
            const lovibond = parseFloat(document.getElementById('lovibondInput').value);
            if (!isNaN(lovibond)) {
                const srm = lovibondToSrm(lovibond);
                document.getElementById('lovibondResult').textContent = `SRM: ${srm.toFixed(2)} | EBC: ${srmToEbc(srm).toFixed(2)}`;
            } else {
                document.getElementById('lovibondResult').textContent = 'SRM: --';
            }
        }
        
        window.calculateGravity = function() {
            const kg = parseFloat(document.getElementById('extractInput').value);
            const liters = parseFloat(document.getElementById('volumeInput').value);
            
            if (!isNaN(kg) && !isNaN(liters) && liters > 0) {
                // Assumendo efficienza del 75% e estratto medio del 80%
                const points = (kg * 1000 * 0.80 * 0.75 * 8.345) / liters;
                const og = 1 + (points / 1000);
                document.getElementById('gravityResult').textContent = `OG: ${og.toFixed(3)}`;
            } else {
                document.getElementById('gravityResult').textContent = 'OG: ----';
            }
        }
        
        // Funzione per cambiare tab
        window.switchTab = function(tabName) {
            // Rimuovi active da tutti i tab e content
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.content').forEach(content => content.classList.remove('active'));
            
            // Attiva il tab selezionato
            const selectedTab = document.querySelector(`[data-tab="${tabName}"]`);
            if (selectedTab) {
                selectedTab.classList.add('active');
            }
            document.getElementById(tabName).classList.add('active');
            
            // Se √® la tab stili, popola la griglia
            if (tabName === 'styles') {
                displayStyles();
            }
        }
        
        // Visualizza stili birra
        function displayStyles() {
            const grid = document.getElementById('styleGrid');
            grid.innerHTML = beerStyles.map(style => `
                <div class="style-card">
                    <div class="style-name">${style.name}</div>
                    <div class="style-specs">
                        <div><strong>OG:</strong> ${style.og}</div>
                        <div><strong>FG:</strong> ${style.fg}</div>
                        <div><strong>IBU:</strong> ${style.ibu}</div>
                        <div><strong>ABV:</strong> ${style.abv}</div>
                        <div><strong>EBC:</strong> ${style.ebc}</div>
                    </div>
                    <div class="style-malts">
                        <strong>Malti tipici:</strong><br>
                        ${style.malts}
                    </div>
                    <div style="margin-top: 10px; color: #666; font-size: 0.9em;">
                        ${style.description}
                    </div>
                </div>
            `).join('');
        }
        
        // Event listeners
        document.addEventListener('DOMContentLoaded', function() {
            // Cerca button
            document.getElementById('searchButton').addEventListener('click', searchMalts);
            
            // Tabs
            document.querySelectorAll('.tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    const tabName = this.getAttribute('data-tab');
                    switchTab(tabName);
                });
            });
            
            // Calcola button
            document.getElementById('calculateButton').addEventListener('click', calculateRecipe);
            
            // Convertitori
            document.getElementById('ebcInput').addEventListener('input', convertEBC);
            document.getElementById('srmInput').addEventListener('input', convertSRM);
            document.getElementById('lovibondInput').addEventListener('input', convertLovibond);
            document.getElementById('extractInput').addEventListener('input', calculateGravity);
            document.getElementById('volumeInput').addEventListener('input', calculateGravity);
            
            // Inizializza con tutti i malti
            searchMalts();
        });
    </script>
</body>
</html>